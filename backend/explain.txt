-[ RECORD 1 ]---------------------------------------------------------------------------------------
indexname | services_pkey
indexdef  | CREATE UNIQUE INDEX services_pkey ON public.services USING btree (id)
-[ RECORD 2 ]---------------------------------------------------------------------------------------
indexname | idx_services_artist_price
indexdef  | CREATE INDEX idx_services_artist_price ON public.services USING btree (artist_id, price)

-[ RECORD 1 ]-----------------------------------------------------------------------------------------------------------
indexname | service_provider_profiles_pkey
indexdef  | CREATE UNIQUE INDEX service_provider_profiles_pkey ON public.service_provider_profiles USING btree (user_id)
-[ RECORD 2 ]-----------------------------------------------------------------------------------------------------------
indexname | idx_spp_user_id
indexdef  | CREATE INDEX idx_spp_user_id ON public.service_provider_profiles USING btree (user_id)
-[ RECORD 3 ]-----------------------------------------------------------------------------------------------------------
indexname | idx_spp_updated_at
indexdef  | CREATE INDEX idx_spp_updated_at ON public.service_provider_profiles USING btree (updated_at)
-[ RECORD 4 ]-----------------------------------------------------------------------------------------------------------
indexname | idx_spp_location
indexdef  | CREATE INDEX idx_spp_location ON public.service_provider_profiles USING btree (location)

ROLLBACK
-[ RECORD 1 ]------------------------------------------------------------------
indexname | reviews_pkey
indexdef  | CREATE UNIQUE INDEX reviews_pkey ON public.reviews USING btree (id)

-[ RECORD 1 ]-------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Nested Loop  (cost=4.71..18.14 rows=1 width=96) (actual time=0.069..0.101 rows=2 loops=1)
-[ RECORD 2 ]-------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |   Buffers: shared hit=51
-[ RECORD 3 ]-------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |   ->  Nested Loop  (cost=4.44..17.50 rows=1 width=4) (actual time=0.021..0.024 rows=2 loops=1)
-[ RECORD 4 ]-------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         Buffers: shared hit=6
-[ RECORD 5 ]-------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         ->  Index Scan using pg_class_relname_nsp_index on pg_class c  (cost=0.28..8.30 rows=1 width=8) (actual time=0.010..0.011 rows=1 loops=1)
-[ RECORD 6 ]-------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |               Index Cond: (relname = 'services'::name)
-[ RECORD 7 ]-------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |               Filter: (relkind = ANY ('{r,m,p}'::"char"[]))
-[ RECORD 8 ]-------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |               Buffers: shared hit=3
-[ RECORD 9 ]-------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         ->  Bitmap Heap Scan on pg_index x  (cost=4.16..9.19 rows=2 width=8) (actual time=0.008..0.010 rows=2 loops=1)
-[ RECORD 10 ]------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |               Recheck Cond: (indrelid = c.oid)
-[ RECORD 11 ]------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |               Heap Blocks: exact=2
-[ RECORD 12 ]------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |               Buffers: shared hit=3
-[ RECORD 13 ]------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |               ->  Bitmap Index Scan on pg_index_indrelid_index  (cost=0.00..4.16 rows=2 width=0) (actual time=0.004..0.004 rows=2 loops=1)
-[ RECORD 14 ]------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |                     Index Cond: (indrelid = c.oid)
-[ RECORD 15 ]------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |                     Buffers: shared hit=1
-[ RECORD 16 ]------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |   ->  Index Scan using pg_class_oid_index on pg_class i  (cost=0.28..0.63 rows=1 width=72) (actual time=0.003..0.003 rows=1 loops=2)
-[ RECORD 17 ]------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         Index Cond: (oid = x.indexrelid)
-[ RECORD 18 ]------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         Filter: (relkind = ANY ('{i,I}'::"char"[]))
-[ RECORD 19 ]------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         Buffers: shared hit=6
-[ RECORD 20 ]------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Planning:
-[ RECORD 21 ]------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |   Buffers: shared hit=25
-[ RECORD 22 ]------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Planning Time: 0.540 ms
-[ RECORD 23 ]------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Execution Time: 0.153 ms

-[ RECORD 1 ]-----------------------------------------------------------------------------------------------------------
indexname | service_provider_profiles_pkey
indexdef  | CREATE UNIQUE INDEX service_provider_profiles_pkey ON public.service_provider_profiles USING btree (user_id)
-[ RECORD 2 ]-----------------------------------------------------------------------------------------------------------
indexname | idx_spp_user_id
indexdef  | CREATE INDEX idx_spp_user_id ON public.service_provider_profiles USING btree (user_id)
-[ RECORD 3 ]-----------------------------------------------------------------------------------------------------------
indexname | idx_spp_updated_at
indexdef  | CREATE INDEX idx_spp_updated_at ON public.service_provider_profiles USING btree (updated_at)
-[ RECORD 4 ]-----------------------------------------------------------------------------------------------------------
indexname | idx_spp_location
indexdef  | CREATE INDEX idx_spp_location ON public.service_provider_profiles USING btree (location)

-[ RECORD 1 ]------------------------------------------------------------------------------
indexname | ix_bookings_status
indexdef  | CREATE INDEX ix_bookings_status ON public.bookings USING btree (status)
-[ RECORD 2 ]------------------------------------------------------------------------------
indexname | bookings_pkey
indexdef  | CREATE UNIQUE INDEX bookings_pkey ON public.bookings USING btree (id)
-[ RECORD 3 ]------------------------------------------------------------------------------
indexname | ix_bookings_start_time
indexdef  | CREATE INDEX ix_bookings_start_time ON public.bookings USING btree (start_time)
-[ RECORD 4 ]------------------------------------------------------------------------------
indexname | ix_bookings_artist_id
indexdef  | CREATE INDEX ix_bookings_artist_id ON public.bookings USING btree (artist_id)

-[ RECORD 1 ]------------------------------------------------------------------
indexname | reviews_pkey
indexdef  | CREATE UNIQUE INDEX reviews_pkey ON public.reviews USING btree (id)

-[ RECORD 1 ]----------------------------------------------------------------------
indexname | users_pkey
indexdef  | CREATE UNIQUE INDEX users_pkey ON public.users USING btree (id)
-[ RECORD 2 ]----------------------------------------------------------------------
indexname | users_email_key
indexdef  | CREATE UNIQUE INDEX users_email_key ON public.users USING btree (email)

List of indexes
-[ RECORD 1 ]-+--------------
Schema        | public
Name          | services_pkey
Type          | index
Owner         | appuser
Table         | services
Persistence   | permanent
Access method | btree
Size          | 16 kB
Description   | 

List of indexes
-[ RECORD 1 ]-+-------------------------------
Schema        | public
Name          | service_provider_profiles_pkey
Type          | index
Owner         | appuser
Table         | service_provider_profiles
Persistence   | permanent
Access method | btree
Size          | 16 kB
Description   | 

List of indexes
-[ RECORD 1 ]-+---------------------
Schema        | public
Name          | bookings_pkey
Type          | index
Owner         | appuser
Table         | bookings
Persistence   | permanent
Access method | btree
Size          | 16 kB
Description   | 
-[ RECORD 2 ]-+---------------------
Schema        | public
Name          | bookings_simple_pkey
Type          | index
Owner         | appuser
Table         | bookings_simple
Persistence   | permanent
Access method | btree
Size          | 16 kB
Description   | 

List of indexes
-[ RECORD 1 ]-+-------------
Schema        | public
Name          | reviews_pkey
Type          | index
Owner         | appuser
Table         | reviews
Persistence   | permanent
Access method | btree
Size          | 8192 bytes
Description   | 

List of indexes
-[ RECORD 1 ]-+----------------
Schema        | public
Name          | users_email_key
Type          | index
Owner         | appuser
Table         | users
Persistence   | permanent
Access method | btree
Size          | 16 kB
Description   | 
-[ RECORD 2 ]-+----------------
Schema        | public
Name          | users_pkey
Type          | index
Owner         | appuser
Table         | users
Persistence   | permanent
Access method | btree
Size          | 16 kB
Description   | 

CREATE EXTENSION
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
-[ RECORD 1 ]-----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Limit  (cost=0.28..8.30 rows=1 width=167) (actual time=0.015..0.025 rows=5 loops=1)
-[ RECORD 2 ]-----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |   Buffers: shared hit=5
-[ RECORD 3 ]-----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |   ->  Index Scan Backward using ix_messages_request_id_id on messages m  (cost=0.28..8.30 rows=1 width=167) (actual time=0.015..0.023 rows=5 loops=1)
-[ RECORD 4 ]-----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         Index Cond: (booking_request_id = 73)
-[ RECORD 5 ]-----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         Filter: (visible_to = ANY ('{both,artist}'::visibleto[]))
-[ RECORD 6 ]-----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         Buffers: shared hit=5
-[ RECORD 7 ]-----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Planning:
-[ RECORD 8 ]-----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |   Buffers: shared hit=289
-[ RECORD 9 ]-----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Planning Time: 0.685 ms
-[ RECORD 10 ]----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Execution Time: 0.052 ms

-[ RECORD 1 ]-----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Limit  (cost=0.28..8.30 rows=1 width=167) (actual time=0.023..0.029 rows=5 loops=1)
-[ RECORD 2 ]-----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |   Buffers: shared hit=5
-[ RECORD 3 ]-----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |   ->  Index Scan Backward using ix_messages_request_id_id on messages m  (cost=0.28..8.30 rows=1 width=167) (actual time=0.022..0.027 rows=5 loops=1)
-[ RECORD 4 ]-----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         Index Cond: (booking_request_id = 73)
-[ RECORD 5 ]-----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         Filter: (visible_to = ANY ('{both,artist}'::visibleto[]))
-[ RECORD 6 ]-----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         Buffers: shared hit=5
-[ RECORD 7 ]-----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Planning Time: 0.159 ms
-[ RECORD 8 ]-----------------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Execution Time: 0.053 ms

-[ RECORD 1 ]---------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Limit  (cost=47.20..47.28 rows=29 width=167) (actual time=0.101..0.107 rows=46 loops=1)
-[ RECORD 2 ]---------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |   Buffers: shared hit=5
-[ RECORD 3 ]---------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |   ->  Sort  (cost=47.20..47.28 rows=29 width=167) (actual time=0.101..0.103 rows=46 loops=1)
-[ RECORD 4 ]---------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         Sort Key: id DESC
-[ RECORD 5 ]---------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         Sort Method: quicksort  Memory: 31kB
-[ RECORD 6 ]---------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         Buffers: shared hit=5
-[ RECORD 7 ]---------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         ->  Bitmap Heap Scan on messages m  (cost=4.51..46.50 rows=29 width=167) (actual time=0.062..0.082 rows=46 loops=1)
-[ RECORD 8 ]---------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |               Recheck Cond: (booking_request_id = 60)
-[ RECORD 9 ]---------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |               Filter: (visible_to = ANY ('{both,client}'::visibleto[]))
-[ RECORD 10 ]--------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |               Rows Removed by Filter: 2
-[ RECORD 11 ]--------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |               Heap Blocks: exact=3
-[ RECORD 12 ]--------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |               Buffers: shared hit=5
-[ RECORD 13 ]--------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |               ->  Bitmap Index Scan on ix_messages_req_vis_time  (cost=0.00..4.50 rows=30 width=0) (actual time=0.049..0.050 rows=48 loops=1)
-[ RECORD 14 ]--------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |                     Index Cond: (booking_request_id = 60)
-[ RECORD 15 ]--------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |                     Buffers: shared hit=2
-[ RECORD 16 ]--------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Planning Time: 0.154 ms
-[ RECORD 17 ]--------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Execution Time: 0.138 ms

-[ RECORD 1 ]--------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Limit  (cost=0.28..8.30 rows=1 width=167) (actual time=0.012..0.013 rows=1 loops=1)
-[ RECORD 2 ]--------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |   Buffers: shared hit=3
-[ RECORD 3 ]--------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |   ->  Index Scan using ix_messages_request_id_id on messages m  (cost=0.28..8.30 rows=1 width=167) (actual time=0.011..0.011 rows=1 loops=1)
-[ RECORD 4 ]--------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         Index Cond: ((booking_request_id = 58) AND (id > 2398))
-[ RECORD 5 ]--------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         Filter: (visible_to = ANY ('{both,client}'::visibleto[]))
-[ RECORD 6 ]--------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |         Buffers: shared hit=3
-[ RECORD 7 ]--------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Planning:
-[ RECORD 8 ]--------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN |   Buffers: shared hit=8
-[ RECORD 9 ]--------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Planning Time: 0.258 ms
-[ RECORD 10 ]-------------------------------------------------------------------------------------------------------------------------------------------
QUERY PLAN | Execution Time: 0.033 ms

List of tables
-[ RECORD 1 ]-+----------
Schema        | public
Name          | sessions
Type          | table
Owner         | appuser
Persistence   | permanent
Access method | heap
Size          | 0 bytes
Description   | 

                                                                          Table "public.sessions"
          Column          |            Type             | Collation | Nullable |               Default                | Storage  | Compression | Stats target | Description 
--------------------------+-----------------------------+-----------+----------+--------------------------------------+----------+-------------+--------------+-------------
 id                       | integer                     |           | not null | nextval('sessions_id_seq'::regclass) | plain    |             |              | 
 user_id                  | integer                     |           | not null |                                      | plain    |             |              | 
 refresh_token_hash       | character varying(128)      |           |          |                                      | extended |             |              | 
 refresh_token_expires_at | timestamp without time zone |           |          |                                      | plain    |             |              | 
 refresh_jti              | character varying(64)       |           |          |                                      | extended |             |              | 
 prev_refresh_token_hash  | character varying(128)      |           |          |                                      | extended |             |              | 
 prev_rotated_at          | timestamp without time zone |           |          |                                      | plain    |             |              | 
 revoked_at               | timestamp without time zone |           |          |                                      | plain    |             |              | 
 last_used_at             | timestamp without time zone |           |          |                                      | plain    |             |              | 
 created_at               | timestamp without time zone |           |          |                                      | plain    |             |              | 
 updated_at               | timestamp without time zone |           |          |                                      | plain    |             |              | 
Indexes:
    "sessions_pkey" PRIMARY KEY, btree (id)
    "ix_sessions_refresh_hash" btree (refresh_token_hash)
    "ix_sessions_refresh_jti" UNIQUE, btree (refresh_jti)
    "ix_sessions_revoked_at" btree (revoked_at)
    "ix_sessions_user_id" btree (user_id)
Foreign-key constraints:
    "sessions_user_id_fkey" FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
Access method: heap

List of tables
-[ RECORD 1 ]-+-----------
Schema        | public
Name          | sessions
Type          | table
Owner         | appuser
Persistence   | permanent
Access method | heap
Size          | 8192 bytes
Description   | 

                                                                          Table "public.sessions"
          Column          |            Type             | Collation | Nullable |               Default                | Storage  | Compression | Stats target | Description 
--------------------------+-----------------------------+-----------+----------+--------------------------------------+----------+-------------+--------------+-------------
 id                       | integer                     |           | not null | nextval('sessions_id_seq'::regclass) | plain    |             |              | 
 user_id                  | integer                     |           | not null |                                      | plain    |             |              | 
 refresh_token_hash       | character varying(128)      |           |          |                                      | extended |             |              | 
 refresh_token_expires_at | timestamp without time zone |           |          |                                      | plain    |             |              | 
 refresh_jti              | character varying(64)       |           |          |                                      | extended |             |              | 
 prev_refresh_token_hash  | character varying(128)      |           |          |                                      | extended |             |              | 
 prev_rotated_at          | timestamp without time zone |           |          |                                      | plain    |             |              | 
 revoked_at               | timestamp without time zone |           |          |                                      | plain    |             |              | 
 last_used_at             | timestamp without time zone |           |          |                                      | plain    |             |              | 
 created_at               | timestamp without time zone |           |          |                                      | plain    |             |              | 
 updated_at               | timestamp without time zone |           |          |                                      | plain    |             |              | 
Indexes:
    "sessions_pkey" PRIMARY KEY, btree (id)
    "ix_sessions_refresh_hash" btree (refresh_token_hash)
    "ix_sessions_refresh_jti" UNIQUE, btree (refresh_jti)
    "ix_sessions_revoked_at" btree (revoked_at)
    "ix_sessions_user_id" btree (user_id)
Foreign-key constraints:
    "sessions_user_id_fkey" FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
Access method: heap

List of tables
-[ RECORD 1 ]-+-----------
Schema        | public
Name          | sessions
Type          | table
Owner         | appuser
Persistence   | permanent
Access method | heap
Size          | 8192 bytes
Description   | 

ROLLBACK
List of tables
-[ RECORD 1 ]-+-----------
Schema        | public
Name          | sessions
Type          | table
Owner         | appuser
Persistence   | permanent
Access method | heap
Size          | 8192 bytes
Description   | 

                                                                          Table "public.sessions"
          Column          |            Type             | Collation | Nullable |               Default                | Storage  | Compression | Stats target | Description 
--------------------------+-----------------------------+-----------+----------+--------------------------------------+----------+-------------+--------------+-------------
 id                       | integer                     |           | not null | nextval('sessions_id_seq'::regclass) | plain    |             |              | 
 user_id                  | integer                     |           | not null |                                      | plain    |             |              | 
 refresh_token_hash       | character varying(128)      |           |          |                                      | extended |             |              | 
 refresh_token_expires_at | timestamp without time zone |           |          |                                      | plain    |             |              | 
 refresh_jti              | character varying(64)       |           |          |                                      | extended |             |              | 
 prev_refresh_token_hash  | character varying(128)      |           |          |                                      | extended |             |              | 
 prev_rotated_at          | timestamp without time zone |           |          |                                      | plain    |             |              | 
 revoked_at               | timestamp without time zone |           |          |                                      | plain    |             |              | 
 last_used_at             | timestamp without time zone |           |          |                                      | plain    |             |              | 
 created_at               | timestamp without time zone |           |          |                                      | plain    |             |              | 
 updated_at               | timestamp without time zone |           |          |                                      | plain    |             |              | 
Indexes:
    "sessions_pkey" PRIMARY KEY, btree (id)
    "ix_sessions_refresh_hash" btree (refresh_token_hash)
    "ix_sessions_refresh_jti" UNIQUE, btree (refresh_jti)
    "ix_sessions_revoked_at" btree (revoked_at)
    "ix_sessions_user_id" btree (user_id)
Foreign-key constraints:
    "sessions_user_id_fkey" FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
Access method: heap

-[ RECORD 1 ]--+-------
current_schema | public

-[ RECORD 1 ]-------
search_path | public

-[ RECORD 1 ]--+-------
current_schema | public

-[ RECORD 1 ]--------
schemaname | public
tablename  | sessions

-[ RECORD 1 ]+---------
table_schema | public
table_name   | sessions

